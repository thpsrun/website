{% extends "admin/base_site.html" %}
{% load i18n %}

{% block title %}Manage Main Page API Visibility - {{ game.name }}{% endblock %}

{% block content %}
<h2>Main Page API Visibility: {{ game.name }}</h2>
<p>Check the category + variable:value pairs to control which runs appear on the Main Page's API. A run will appear on there if its category is checked <strong>AND</strong> all of its associaed variable:value pairs are also checked.</p>

{% if messages %}
<ul class="messagelist">
    {% for message in messages %}
    <li class="{{ message.tags }}">{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

    <form method="post">
        {% csrf_token %}
        <table style="border-collapse: collapse; width: 100%; max-width: 800px;">
            <thead>
                <tr>
                    <th style="text-align: left; padding: 8px; border-bottom: 2px solid var(--hairline-color);">
                        Category + Variable:Value Pairs
                    </th>
                    <th style="text-align: center; padding: 8px; border-bottom: 2px solid var(--hairline-color); width: 120px;">
                        On Main
                    </th>
                </tr>
            </thead>
            <tbody>
                {% for cat_data in categories %}
                <tr style="background: var(--darkened-bg);">
                    <td style="padding: 8px; font-weight: bold;">
                        {{ cat_data.category.name }}
                        <span style="color: var(--quiet-link-fg); font-size: 0.85em;">({{ cat_data.category.type }})</span>
                    </td>
                    <td style="text-align: center; padding: 8px;">
                        <input type="checkbox" name="cat_{{ cat_data.category.id }}" {% if cat_data.category.appear_on_main %}checked{% endif %}>
                    </td>
                </tr>
                {% for vv in cat_data.variable_values %}
                <tr>
                    <td style="padding: 8px 8px 8px 40px; color: var(--body-quiet-color);">
                        <span style="color: var(--quiet-link-fg);">{{ vv.variable_name }}:</span> {{ vv.value.name }}
                    </td>
                    <td style="text-align: center; padding: 8px;">
                        <input type="checkbox" name="vv_{{ vv.value.value }}" {% if vv.value.appear_on_main %}checked{% endif %}>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td style="padding: 8px 8px 8px 40px; color: var(--body-quiet-color); font-style: italic;">
                        (no subcategory variables within this category)
                    </td>
                    <td></td>
                </tr>
                {% endfor %}
                {% endfor %}
            </tbody>
        </table>
        <br>
        <input type="submit" value="Save Changes" class="default">
        <a href="{% url 'admin:srl_games_changelist' %}" style="margin-left: 10px;">Cancel</a>
    </form>
{% endblock %}
